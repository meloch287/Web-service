# –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –°–∏—Å—Ç–µ–º—ã –ë—ã—Å—Ç—Ä—ã—Ö –ü–ª–∞—Ç–µ–∂–µ–π (–°–ë–ü)

–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º —Ç–µ–æ—Ä–∏–∏ –º–∞—Å—Å–æ–≤–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è (G/G/c/K). –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –∞–Ω–∞–ª–∏–∑ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –ø–ª–∞—Ç–µ–∂–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –æ—Ü–µ–Ω–∫—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è SLA.

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã](#–æ–±–∑–æ—Ä-—Å–∏—Å—Ç–µ–º—ã)
2. [–¢–µ–æ—Ä–∏—è –º–∞—Å—Å–æ–≤–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è G/G/c/K](#—Ç–µ–æ—Ä–∏—è-–º–∞—Å—Å–æ–≤–æ–≥–æ-–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è-ggck)
3. [–§–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Ç–æ–∫–æ–≤ N_bg(t) –∏ N_anom(t)](#—Ñ–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è-–ø–æ—Ç–æ–∫–æ–≤)
4. [–°–∏–º—É–ª—è—Ü–∏—è –°–ë–ü](#—Å–∏–º—É–ª—è—Ü–∏—è-—Å–±–ø)
5. [–°–∏–º—É–ª—è—Ü–∏—è –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π](#—Å–∏–º—É–ª—è—Ü–∏—è-–±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π)
6. [–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ](#–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ-–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ)
7. [–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑](#—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π-–∞–Ω–∞–ª–∏–∑)
8. [SLA-–∞–Ω–∞–ª–∏–∑](#sla-–∞–Ω–∞–ª–∏–∑)
9. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
10. [–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö](#—Ö—Ä–∞–Ω–µ–Ω–∏–µ-–¥–∞–Ω–Ω—ã—Ö)
11. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
12. [API Reference](#api-reference)
13. [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

---

## –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è:
- –ò–º–∏—Ç–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è **–°–∏—Å—Ç–µ–º—ã –ë—ã—Å—Ç—Ä—ã—Ö –ü–ª–∞—Ç–µ–∂–µ–π (–°–ë–ü)**
- –ê–Ω–∞–ª–∏–∑–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –ø–ª–∞—Ç–µ–∂–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º **—Ç–µ–æ—Ä–∏–∏ –º–∞—Å—Å–æ–≤–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è**
- –†–∞—Å—á—ë—Ç–∞ –º–µ—Ç—Ä–∏–∫ **G/G/c/K –º–æ–¥–µ–ª–∏**: –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏ œÅ(t), –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ P_block, –¥–æ–ª—è –ø–æ—Ç–µ—Ä—å D_loss
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏—è **—Ñ–æ—Ä–º—É–ª—ã –ü–æ–ª—è—á–µ–∫–∞-–•–∏–Ω—á–∏–Ω–∞** –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ –æ–∂–∏–¥–∞–Ω–∏—è
- –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è **–ø–ª–∞—Ç–µ–∂–Ω—ã—Ö –∞–Ω–æ–º–∞–ª–∏–π**: –º–∏–∫—Ä–æ—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –≤—ã—Å–æ–∫–∏–µ —Å—É–º–º—ã, –≤—Å–ø–ª–µ—Å–∫–∏ —á–∞—Å—Ç–æ—Ç—ã
- –û—Ü–µ–Ω–∫–∏ SLA –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–æ—á–µ–∫ –æ—Ç–∫–∞–∑–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|----------|
| **SBP Simulator** | –°–∏–º—É–ª—è—Ç–æ—Ä –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Å –æ—á–µ—Ä–µ–¥—å—é G/G/c/K |
| **Queuing Analyzer** | –†–∞—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫ —Ç–µ–æ—Ä–∏–∏ –º–∞—Å—Å–æ–≤–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è |
| **Markov Model** | –ú–∞—Ä–∫–æ–≤—Å–∫–∞—è –º–æ–¥–µ–ª—å —Å–æ—Å—Ç–æ—è–Ω–∏–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π |
| **PostgreSQL** | –•—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–∏–º—É–ª—è—Ü–∏–∏ |

---

## –¢–µ–æ—Ä–∏—è –º–∞—Å—Å–æ–≤–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è G/G/c/K

### –ú–æ–¥–µ–ª—å —Å–∏—Å—Ç–µ–º—ã

–ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ —Å–∏—Å—Ç–µ–º–∞ –º–∞—Å—Å–æ–≤–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è **G/G/c/K**:
- **G** ‚Äî –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ö–æ–¥—è—â–µ–≥–æ –ø–æ—Ç–æ–∫–∞
- **G** ‚Äî –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è  
- **c** ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Ä–≤–µ—Ä–æ–≤ (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)
- **K** ‚Äî —ë–º–∫–æ—Å—Ç—å –æ—á–µ—Ä–µ–¥–∏

### –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏

```
œÅ(t) = Œª(t) / (c √ó Œº)
```

–≥–¥–µ:
- `Œª(t)` ‚Äî –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –≤—Ö–æ–¥—è—â–µ–≥–æ –ø–æ—Ç–æ–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- `c` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Ä–≤–µ—Ä–æ–≤
- `Œº` ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

### –§–æ—Ä–º—É–ª–∞ –ü–æ–ª—è—á–µ–∫–∞-–•–∏–Ω—á–∏–Ω–∞

–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –≤ –æ—á–µ—Ä–µ–¥–∏:

```
E[W] = (œÅ / (1 - œÅ)) √ó ((1 + C_s¬≤) / 2) √ó (1 / Œº)
```

–≥–¥–µ `C_s¬≤` ‚Äî –∫–≤–∞–¥—Ä–∞—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –≤–∞—Ä–∏–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è.

### –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (Erlang C)

```
P_wait = (a^c / c!) √ó (c / (c - a)) / [Œ£(a^n/n!) + (a^c/c!) √ó (c/(c-a))]
```

–≥–¥–µ `a = Œª/Œº` ‚Äî –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞.

### –î–æ–ª—è –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

```
D_loss = ‚à´P_block(t) √ó n_tot(t) dt / ‚à´n_tot(t) dt
```

### –û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –¥–æ –ø–µ—Ä–≤–æ–≥–æ –æ—Ç–∫–∞–∑–∞

```
E[T_fail] = 1 / Œª_margin
```

–≥–¥–µ `Œª_margin = (œÅ_threshold - œÅ) √ó c √ó Œº`

---

## –§–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Ç–æ–∫–æ–≤

### –°—É–ø–µ—Ä–ø–æ–∑–∏—Ü–∏—è –ø–æ—Ç–æ–∫–æ–≤ N(t) = N_bg(t) + N_anom(t)

–û–±—â–∏–π –ø–æ—Ç–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Ä–∞–∑–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ –¥–≤–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:

**–§–æ–Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ N_bg(t)** ‚Äî –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ –ø–æ –≥–∞—É—Å—Å–æ–≤–æ–π —Ñ–æ—Ä–º—É–ª–µ:
```
N_bg(t) = A √ó exp(-(t - t_m)¬≤ / (2œÉ¬≤))
```

–≥–¥–µ:
- `A` ‚Äî –∞–º–ø–ª–∏—Ç—É–¥–∞ –ø–∏–∫–∞ (–º–∞–∫—Å. —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π/—Å–µ–∫)
- `t_m` ‚Äî –≤—Ä–µ–º—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –º–∞–∫—Å–∏–º—É–º–∞
- `œÉ` ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (—à–∏—Ä–∏–Ω–∞ –ø–∏–∫–∞)

**–ê–Ω–æ–º–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ N_anom(t)** ‚Äî –∞—Ç–∞–∫—É—é—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ —Å –≤—ã–±–∏—Ä–∞–µ–º—ã–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º:
- Normal (Gaussian)
- Exponential
- Poisson
- Pareto (heavy-tail)

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from app.models import TrafficFlowConfig, BackgroundTrafficParams, AnomalousTrafficParams, DistributionParams, DistributionType
from app.traffic import TrafficFlowGenerator

config = TrafficFlowConfig(
    background=BackgroundTrafficParams(A=1000, t_m=12.0, sigma=4.0),
    anomalous=AnomalousTrafficParams(
        distribution=DistributionType.EXPONENTIAL,
        total_volume=5000,
        start_time=10.0,
        duration=5.0,
        params=DistributionParams(rate=2.0)
    )
)

generator = TrafficFlowGenerator(config)
time_series = generator.generate_time_series(0, 24, dt=0.1)

print(f"Background: {time_series.background_count}")
print(f"Anomalous: {time_series.anomalous_count}")
```

### GGcKQueueingSystem

```python
from app.models import QueueingSystemConfig
from app.analysis import GGcKQueueingSystem

config = QueueingSystemConfig(c=10, K=1000, mu=100.0, sla_epsilon=0.01, sla_delta=0.05)
system = GGcKQueueingSystem(config)

analysis = system.analyze(time_series)
report = system.generate_report(analysis)

print(f"œÅ avg: {analysis.utilization.avg_utilization:.2f}")
print(f"D_loss: {analysis.d_loss.d_loss:.4f}")
print(f"E[T_fail]: {analysis.e_t_fail:.2f}s")
print(f"SLA compliant: {report.overall_compliant}")
```

### –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

–ö–∞–∂–¥–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –º–∞—Ä–∫–∏—Ä—É–µ—Ç—Å—è –¥–ª—è ML-—Ä–∞–∑–º–µ—Ç–∫–∏:
```python
{
    "traffic_type": "background" | "anomalous",
    "distribution": "gaussian" | "exponential" | "poisson" | "pareto"
}
```

### –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

–ü–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ `.kiro/specs/traffic-flow-formalization/`:
- `requirements.md` ‚Äî —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è EARS/INCOSE
- `design.md` ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ correctness properties
- `tasks.md` ‚Äî –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
from app.analysis import GGcKQueueingSystem

config = QueueingSystemConfig(c=10, K=1000, mu=100.0, sla_epsilon=0.01, sla_delta=0.05)
system = GGcKQueueingSystem(config)

analysis = system.analyze(time_series)
report = system.generate_report(analysis)

print(f"D_loss: {report.d_loss}")
print(f"SLA Compliant: {report.overall_compliant}")
```

### –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

–ö–∞–∂–¥–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –º–∞—Ä–∫–∏—Ä—É–µ—Ç—Å—è –¥–ª—è ML-—Ä–∞–∑–º–µ—Ç–∫–∏:
```python
{
    "traffic_type": "background" | "anomalous",
    "distribution": "gaussian" | "exponential" | "poisson" | "pareto"
}
```

---

## –§–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Ç–æ–∫–æ–≤

### –°—É–ø–µ—Ä–ø–æ–∑–∏—Ü–∏—è –ø–æ—Ç–æ–∫–æ–≤ N(t) = N_bg(t) + N_anom(t)

–û–±—â–∏–π –ø–æ—Ç–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Ä–∞–∑–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ –¥–≤–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:

**–§–æ–Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ N_bg(t)** ‚Äî –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ –ø–æ –≥–∞—É—Å—Å–æ–≤–æ–π —Ñ–æ—Ä–º—É–ª–µ:
```
N_bg(t) = A √ó exp(-(t - t_m)¬≤ / (2œÉ¬≤))
```

–≥–¥–µ:
- `A` ‚Äî –∞–º–ø–ª–∏—Ç—É–¥–∞ –ø–∏–∫–∞ (–º–∞–∫—Å. —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π/—Å–µ–∫)
- `t_m` ‚Äî –≤—Ä–µ–º—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –º–∞–∫—Å–∏–º—É–º–∞
- `œÉ` ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (—à–∏—Ä–∏–Ω–∞ –ø–∏–∫–∞)

**–ê–Ω–æ–º–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ N_anom(t)** ‚Äî –∞—Ç–∞–∫—É—é—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ —Å –≤—ã–±–∏—Ä–∞–µ–º—ã–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º:
- Normal (Gaussian)
- Exponential
- Poisson
- Pareto (heavy-tail)

### –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

–ö–∞–∂–¥–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –º–∞—Ä–∫–∏—Ä—É–µ—Ç—Å—è –¥–ª—è ML-—Ä–∞–∑–º–µ—Ç–∫–∏:
```python
{
    "traffic_type": "background" | "anomalous",
    "distribution": "gaussian" | "exponential" | "poisson" | "pareto"
}
```

### –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

–ü–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ `.kiro/specs/traffic-flow-formalization/`:
- `requirements.md` ‚Äî —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è EARS/INCOSE
- `design.md` ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ correctness properties
- `tasks.md` ‚Äî –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –û—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ —Ä–∞–±–æ—Ç—ã

```bash
# 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ JSON
python generate_transactions.py --transactions 10000 --anomaly-ratio 0.15

# 2. –ó–∞–ø—É—Å–∫ receiver (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
python run_receiver.py

# 3. –ó–∞–ø—É—Å–∫ —Å–∏–º—É–ª—è—Ü–∏–∏
python run_bank_simulation.py --rps 100
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
üìÅ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ generate_transactions.py    ‚Üê –ü—Ä–µ–¥–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ JSON
‚îú‚îÄ‚îÄ run_bank_simulation.py      ‚Üê –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –Ω–∞ receiver
‚îú‚îÄ‚îÄ run_sender.py               ‚Üê –ó–∞–ø—É—Å–∫ sender API (–ø–æ—Ä—Ç 8000)
‚îú‚îÄ‚îÄ run_receiver.py             ‚Üê –ó–∞–ø—É—Å–∫ receiver API (–ø–æ—Ä—Ç 8001)
‚îú‚îÄ‚îÄ setup_db.py                 ‚Üê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–î
‚îÇ
‚îú‚îÄ‚îÄ üìÅ app/                     ‚Üê –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ sender.py               ‚Üê FastAPI sender
‚îÇ   ‚îú‚îÄ‚îÄ receiver.py             ‚Üê FastAPI receiver
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ analysis/            ‚Üê –ê–Ω–∞–ª–∏–∑ –∏ –º–µ—Ç—Ä–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ attacks/             ‚Üê –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –∞—Ç–∞–∫
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ models/              ‚Üê Pydantic –º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ traffic/             ‚Üê –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã —Ç—Ä–∞—Ñ–∏–∫–∞
‚îÇ
‚îú‚îÄ‚îÄ üìÅ tools/                   ‚Üê –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ test_traffic_flow.py    ‚Üê –¢–µ—Å—Ç—ã –º–æ–¥—É–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ run_sbp_simulation.py   ‚Üê –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π —Å–∏–º—É–ª—è—Ç–æ—Ä –°–ë–ü
‚îÇ   ‚îî‚îÄ‚îÄ run_simulation.py       ‚Üê CLI –æ–±—ë—Ä—Ç–∫–∞
‚îÇ
‚îú‚îÄ‚îÄ üìÅ data/transactions/       ‚Üê JSON —Ñ–∞–π–ª—ã —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏
‚îî‚îÄ‚îÄ üìÅ reports/                 ‚Üê –ì—Ä–∞—Ñ–∏–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```

---

## –°–∏–º—É–ª—è—Ü–∏—è –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

### –®–∞–≥ 1: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

```bash
python generate_transactions.py --users 100 --transactions 30000 --anomaly-ratio 0.15
```

–°–æ–∑–¥–∞—ë—Ç JSON —Ñ–∞–π–ª –≤ `data/transactions/` —Å:
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ —Å–µ—Å—Å–∏–∏
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –ø–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º
- –°–ø–∏—Å–∫–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ —Å –º–∞—Ä–∫–∏—Ä–æ–≤–∫–æ–π `is_malicious`, `attack_type`, `distribution`

### –®–∞–≥ 2: –ó–∞–ø—É—Å–∫ —Å–∏–º—É–ª—è—Ü–∏–∏

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å receiver
python run_receiver.py

# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ - —Å–∏–º—É–ª—è—Ü–∏—è
python run_bank_simulation.py --input data/transactions/transactions_XXX.json --rps 100
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã generate_transactions.py

| –ü–∞—Ä–∞–º–µ—Ç—Ä | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|---------|----------|
| --users | 100 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| --transactions | 30000 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π |
| --anomaly-ratio | 0.15 | –î–æ–ª—è –∞–Ω–æ–º–∞–ª–∏–π (0-1) |
| --output | data/transactions | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è |

### –¢–∏–ø—ã –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö –∞–Ω–æ–º–∞–ª–∏–π

| –ö–æ–¥ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|-----|----------|
| 0 | NORMAL | –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è |
| 1 | MICRO_TRANSACTION | –ú–∏–∫—Ä–æ—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è (1-100 —Ä—É–±) |
| 2 | HIGH_AMOUNT | –í—ã—Å–æ–∫–∞—è —Å—É–º–º–∞ (500k-5M —Ä—É–±) |
| 3 | UNUSUAL_TIME | –ù–µ–æ–±—ã—á–Ω–æ–µ –≤—Ä–µ–º—è |
| 4 | GEO_ANOMALY | –ì–µ–æ-–∞–Ω–æ–º–∞–ª–∏—è |
| 5 | VELOCITY_SPIKE | –í—Å–ø–ª–µ—Å–∫ —á–∞—Å—Ç–æ—Ç—ã |
| 6 | INTERRUPTED | –ü—Ä–µ—Ä–≤–∞–Ω–Ω—ã–π –ø–ª–∞—Ç—ë–∂ |
| 7 | HIGH_VOLATILITY | –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å —Å—É–º–º—ã |

### –ú–∞—Ä–∫–æ–≤—Å–∫–∞—è –º–æ–¥–µ–ª—å —Å–æ—Å—Ç–æ—è–Ω–∏–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

```
States = {QUEUED, PROCESSING, COMPLETED, REJECTED, TIMEOUT}

–ü–µ—Ä–µ—Ö–æ–¥—ã:
QUEUED ‚Üí PROCESSING (—É—Å–ø–µ—à–Ω–∞—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É)
QUEUED ‚Üí REJECTED (–æ—á–µ—Ä–µ–¥—å –ø–æ–ª–Ω–∞ / –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞)
PROCESSING ‚Üí COMPLETED (—É—Å–ø–µ—à–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)
PROCESSING ‚Üí REJECTED (–ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞ / rate limit)
PROCESSING ‚Üí TIMEOUT (—Ç–∞–π–º–∞—É—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏)
```

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

–ì—Ä–∞—Ñ–∏–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `reports/sbp_*.png`:
1. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∑–∞ 24 —á–∞—Å–∞** ‚Äî —É—Å–ø–µ—à–Ω—ã–µ vs –æ—Ç–∫–ª–æ–Ω—ë–Ω–Ω—ã–µ
2. **–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏ œÅ(t)** ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã
3. **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ P_block(t)** ‚Äî —Å —Ä–∞—Å—á—ë—Ç–æ–º D_loss
4. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏** ‚Äî –ø–æ —Ñ–æ—Ä–º—É–ª–µ –ü–æ–ª—è—á–µ–∫–∞-–•–∏–Ω—á–∏–Ω–∞
5. **–£—Å–ø–µ—à–Ω–æ—Å—Ç—å –ø–æ —Ç–∏–ø–∞–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π** ‚Äî –∞–Ω–∞–ª–∏–∑ –∞–Ω–æ–º–∞–ª–∏–π
6. **–î–ª–∏–Ω–∞ –æ—á–µ—Ä–µ–¥–∏ E[L_q](t)** ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ –æ—á–µ—Ä–µ–¥–∏

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                              –ü–†–ï–î–ì–ï–ù–ï–†–ê–¶–ò–Ø                                  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                                                ‚îÇ
‚îÇ  ‚îÇ generate_transactions.py ‚îÇ  –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞:                          ‚îÇ
‚îÇ  ‚îÇ                         ‚îÇ  ‚Ä¢ –õ–µ–≥–∏—Ç–∏–º–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–Ω–æ—Ä–º. —Ä–∞—Å–ø—Ä.)        ‚îÇ
‚îÇ  ‚îÇ  Transaction Generator  ‚îÇ  ‚Ä¢ –ê–Ω–æ–º–∞–ª–∏–∏ (–ü—É–∞—Å—Å–æ–Ω, –ü–∞—Ä–µ—Ç–æ, –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü.)      ‚îÇ
‚îÇ  ‚îÇ                         ‚îÇ  ‚Ä¢ SQL Injection, XSS, Fraud                   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                                                ‚îÇ
‚îÇ              ‚îÇ                                                              ‚îÇ
‚îÇ              ‚ñº                                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                                                ‚îÇ
‚îÇ  ‚îÇ data/transactions/      ‚îÇ  JSON —Ñ–∞–π–ª—ã —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏:                    ‚îÇ
‚îÇ  ‚îÇ   transactions_XXX.json ‚îÇ  ‚Ä¢ metadata, statistics                        ‚îÇ
‚îÇ  ‚îÇ                         ‚îÇ  ‚Ä¢ users[], transactions[]                     ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚Ä¢ is_malicious, attack_type, distribution     ‚îÇ
‚îÇ              ‚îÇ                                                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                              –°–ò–ú–£–õ–Ø–¶–ò–Ø                                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                                                ‚îÇ
‚îÇ  ‚îÇ run_bank_simulation.py  ‚îÇ  –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π:                          ‚îÇ
‚îÇ  ‚îÇ                         ‚îÇ  ‚Ä¢ –ß—Ç–µ–Ω–∏–µ JSON –¥–∞—Ç–∞—Å–µ—Ç–∞                        ‚îÇ
‚îÇ  ‚îÇ  Bank Simulator         ‚îÇ  ‚Ä¢ Async HTTP –æ—Ç–ø—Ä–∞–≤–∫–∞                         ‚îÇ
‚îÇ  ‚îÇ                         ‚îÇ  ‚Ä¢ –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ latency                         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚Ä¢ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤                           ‚îÇ
‚îÇ              ‚îÇ                                                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         –ó–ê–©–ò–¢–ù–´–ô –ü–ï–†–ò–ú–ï–¢–†                                   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                               ‚îÇ
‚îÇ  ‚îÇ   pfSense 1     ‚îÇ      ‚îÇ   pfSense 2     ‚îÇ                               ‚îÇ
‚îÇ  ‚îÇ                 ‚îÇ      ‚îÇ                 ‚îÇ                               ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Nemesida WAF  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ ‚Ä¢ Firewall      ‚îÇ  –£—Ä–æ–≤–Ω–∏ –∑–∞—â–∏—Ç—ã:               ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ IDS/IPS       ‚îÇ      ‚îÇ ‚Ä¢ Rate Limiting ‚îÇ  1. WAF (L7)                  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Packet Filter ‚îÇ      ‚îÇ ‚Ä¢ GeoIP Block   ‚îÇ  2. IDS/IPS (L3-L4)           ‚îÇ
‚îÇ  ‚îÇ                 ‚îÇ      ‚îÇ                 ‚îÇ  3. Firewall (L3)             ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  4. Rate Limiting             ‚îÇ
‚îÇ           ‚îÇ                        ‚îÇ                                        ‚îÇ
‚îÇ           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                                        ‚îÇ
‚îÇ                        ‚îÇ                                                    ‚îÇ
‚îÇ                        ‚ñº                                                    ‚îÇ
‚îÇ              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                                            ‚îÇ
‚îÇ              ‚îÇ     Zabbix      ‚îÇ  –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:                               ‚îÇ
‚îÇ              ‚îÇ    Monitoring   ‚îÇ  ‚Ä¢ CPU/Memory pfSense                      ‚îÇ
‚îÇ              ‚îÇ                 ‚îÇ  ‚Ä¢ Network throughput                      ‚îÇ
‚îÇ              ‚îÇ                 ‚îÇ  ‚Ä¢ Blocked packets                         ‚îÇ
‚îÇ              ‚îÇ                 ‚îÇ  ‚Ä¢ WAF events                              ‚îÇ
‚îÇ              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         –ó–ê–©–ò–©–ê–ï–ú–´–ô –°–ï–ì–ú–ï–ù–¢                                  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                                                ‚îÇ
‚îÇ  ‚îÇ    RECEIVER             ‚îÇ                                                ‚îÇ
‚îÇ  ‚îÇ    run_receiver.py      ‚îÇ  –§—É–Ω–∫—Ü–∏–∏:                                      ‚îÇ
‚îÇ  ‚îÇ    Port: 8001           ‚îÇ  ‚Ä¢ –ü—Ä–∏—ë–º —Ç—Ä–∞—Ñ–∏–∫–∞                               ‚îÇ
‚îÇ  ‚îÇ                         ‚îÇ  ‚Ä¢ –î–µ—Ç–µ–∫—Ü–∏—è –∞—Ç–∞–∫ (—Å–∏–≥–Ω–∞—Ç—É—Ä—ã)                   ‚îÇ
‚îÇ  ‚îÇ    app/receiver.py      ‚îÇ  ‚Ä¢ –ò–∑–º–µ—Ä–µ–Ω–∏–µ latency                           ‚îÇ
‚îÇ  ‚îÇ                         ‚îÇ  ‚Ä¢ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ SQLite                         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚Ä¢ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞—â–∏—Ç—ã                           ‚îÇ
‚îÇ              ‚îÇ                                                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                              –†–ï–ó–£–õ–¨–¢–ê–¢–´                                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                                                ‚îÇ
‚îÇ  ‚îÇ reports/                ‚îÇ  –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:                              ‚îÇ
‚îÇ  ‚îÇ   simulation_XXX.png    ‚îÇ  ‚Ä¢ –ì—Ä–∞—Ñ–∏–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π                       ‚îÇ
‚îÇ  ‚îÇ                         ‚îÇ  ‚Ä¢ –ú–µ—Ç—Ä–∏–∫–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏                            ‚îÇ
‚îÇ  ‚îÇ                         ‚îÇ  ‚Ä¢ Latency percentiles                         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚Ä¢ SLA compliance                              ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª | –ü–æ—Ä—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|------|------|----------|
| **Generator** | `generate_transactions.py` | - | –ü—Ä–µ–¥–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ JSON |
| **Simulator** | `run_bank_simulation.py` | - | –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏–∑ JSON |
| **Sender API** | `run_sender.py` | 8000 | FastAPI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–∞–º–∏ |
| **Receiver API** | `run_receiver.py` | 8001 | FastAPI –¥–ª—è –ø—Ä–∏—ë–º–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ |

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ—Ç–æ–∫ (—á–µ—Ä–µ–∑ Sender API)

```bash
# 1. –ó–∞–ø—É—Å–∫ receiver
python run_receiver.py

# 2. –ó–∞–ø—É—Å–∫ sender
python run_sender.py

# 3. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ —á–µ—Ä–µ–∑ API
curl -X POST "http://127.0.0.1:8000/start?mode=normal&total_requests=1000&malicious_ratio=0.2"

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
curl http://127.0.0.1:8000/sessions
```

---

## –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è –æ—Å–Ω–æ–≤–∞

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–ø–ø–∞—Ä–∞—Ç —Ç–µ–æ—Ä–∏–∏ –º–∞—Å—Å–æ–≤–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∏ —Ç–µ–æ—Ä–∏–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞.

### –ü—É–∞—Å—Å–æ–Ω–æ–≤—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å

–ü–æ—Ç–æ–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ –ø—É–∞—Å—Å–æ–Ω–æ–≤—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å —Å –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å—é Œª:

```
P(N(t) = k) = (Œªt)^k √ó e^(-Œªt) / k!
```

–≥–¥–µ:
- `N(t)` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ –≤—Ä–µ–º—è t
- `Œª` ‚Äî –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –ø–æ—Ç–æ–∫–∞ (requests/second)
- `k` ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —á–∏—Å–ª–æ —Å–æ–±—ã—Ç–∏–π

**–û—Ü–µ–Ω–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
```python
Œª_MLE = n / T  # Maximum Likelihood Estimation
Var(Œª) = Œª / T
CI = Œª ¬± z_Œ±/2 √ó ‚àö(Œª/T)  # –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
```

### –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

–ú–µ–∂–ø–∞–∫–µ—Ç–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã (IAT) —Å–ª–µ–¥—É—é—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é:

```
f(x) = Œª √ó e^(-Œªx), x ‚â• 0
E[X] = 1/Œª
Var(X) = 1/Œª¬≤
```

### –ú–∞—Ä–∫–æ–≤—Å–∫–∏–µ —Ü–µ–ø–∏

–°–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –º–æ–¥–µ–ª–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ –ú–∞—Ä–∫–æ–≤—Å–∫–∞—è —Ü–µ–ø—å:

```
States = {normal, suspicious, attack, blocked}

Transition Matrix P:
              normal  suspicious  attack  blocked
normal        0.85    0.10        0.04    0.01
suspicious    0.30    0.50        0.15    0.05
attack        0.05    0.10        0.60    0.25
blocked       0.20    0.10        0.20    0.50
```

**–°—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**
```
œÄ = œÄ √ó P, –≥–¥–µ Œ£œÄ_i = 1
```

**–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –¥–æ –∞—Ç–∞–∫–∏:**
```
MTTA = Œ£ N[0,j], –≥–¥–µ N = (I - Q)^(-1)
```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

```python
from app.analysis.statistical import StatisticalAnalyzer, MarkovChainAnalyzer

# –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
analyzer = StatisticalAnalyzer(confidence_level=0.95)

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É–∞—Å—Å–æ–Ω–æ–≤—Å–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
poisson_params = analyzer.calculate_poisson_parameters(
    arrivals=timestamps,
    time_window=3600  # 1 —á–∞—Å
)
# Returns: {lambda: 150.5, variance: 150.5, confidence_interval: (145.2, 155.8)}

# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Ç—Ä–∞—Ñ–∏–∫–∞
model = analyzer.build_traffic_model(timestamps, values)
# Returns: TrafficModel(lambda_intensity, variance, mean, std_dev, distribution, anomaly_threshold)

# –ú–∞—Ä–∫–æ–≤—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
markov = MarkovChainAnalyzer()
markov.update_transition("normal", "suspicious")
markov.update_transition("suspicious", "attack")

stationary = markov.get_stationary_distribution()
attack_prob = markov.get_attack_probability(steps=5)
mtta = markov.get_mean_time_to_attack()
```

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

### –¢–µ—Å—Ç—ã –≥–∏–ø–æ—Ç–µ–∑

–î–ª—è —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –∏ –∞—Ç–∞–∫—É—é—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã:

| –¢–µ—Å—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | H‚ÇÄ | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ |
|------|------------|-----|------------|
| **t-test** | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö | Œº‚ÇÅ = Œº‚ÇÇ | t = (xÃÑ‚ÇÅ - xÃÑ‚ÇÇ) / SE |
| **Mann-Whitney U** | –ù–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ | F‚ÇÅ = F‚ÇÇ | U = n‚ÇÅn‚ÇÇ + n‚ÇÅ(n‚ÇÅ+1)/2 - R‚ÇÅ |
| **Kolmogorov-Smirnov** | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π | F‚ÇÅ = F‚ÇÇ | D = sup|F‚ÇÅ(x) - F‚ÇÇ(x)| |

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π

**–ú–µ—Ç–æ–¥ IQR (Interquartile Range):**
```
Q1 = 25-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å
Q3 = 75-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å
IQR = Q3 - Q1
Threshold = Q3 + 1.5 √ó IQR
```

**–ú–µ—Ç–æ–¥ Z-score:**
```
z = (x - Œº) / œÉ
Anomaly if |z| > z_critical (–æ–±—ã—á–Ω–æ 3)
```

**–ú–µ—Ç–æ–¥ MAD (Median Absolute Deviation):**
```
MAD = median(|x_i - median(x)|)
Threshold = median + 3 √ó 1.4826 √ó MAD
```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

```python
from app.analysis.statistical import AnomalyDetector

detector = AnomalyDetector(window_size=100)

# –û–±—É—á–µ–Ω–∏–µ –Ω–∞ baseline
for value in baseline_traffic:
    detector.update_baseline(value)

# –î–µ—Ç–µ–∫—Ü–∏—è –∞–Ω–æ–º–∞–ª–∏–π
result = detector.detect_anomaly(current_values)
# Returns:
# {
#     "is_anomaly": True,
#     "confidence": 0.95,
#     "z_score": 4.2,
#     "threshold": 1523.5,
#     "statistical_test": {...},
#     "markov_state": "attack",
#     "attack_probability": 0.78
# }
```

---

## SLA-–∞–Ω–∞–ª–∏–∑

### Service Level Objectives (SLO)

| –ú–µ—Ç—Ä–∏–∫–∞ | Target | Warning | Critical | Unit |
|---------|--------|---------|----------|------|
| **Availability** | 99.9% | 99.5% | 99.0% | % |
| **Latency P50** | 50 | 100 | 200 | ms |
| **Latency P95** | 200 | 500 | 1000 | ms |
| **Latency P99** | 500 | 1000 | 2000 | ms |
| **Throughput** | 1000 | 500 | 100 | req/s |
| **Error Rate** | 0.1% | 1.0% | 5.0% | % |
| **Packet Loss** | 0.01% | 0.1% | 1.0% | % |

### –†–∞—Å—á—ë—Ç Compliance

```python
Compliance% = (actual / target) √ó 100  # –¥–ª—è "higher is better"
Compliance% = ((critical - actual) / (critical - target)) √ó 100  # –¥–ª—è "lower is better"
```

### –ö—Ä–∏–≤–∞—è –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏

–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å latency –æ—Ç –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ –∞—Ç–∞–∫–∏ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∏—Ä—É–µ—Ç—Å—è –ø–æ–ª–∏–Ω–æ–º–æ–º:

```
latency(intensity) = a√óx¬≤ + b√óx + c
```

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ—á–∫–∏ —Å—Ä—ã–≤–∞ SLA:**
```
Solve: a√óx¬≤ + b√óx + c = SLA_threshold
x_break = (-b + ‚àö(b¬≤ - 4a(c - threshold))) / 2a
```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

```python
from app.analysis.sla import SLAAnalyzer

sla = SLAAnalyzer()

# –ê–Ω–∞–ª–∏–∑ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
availability = sla.analyze_availability(
    total_requests=10000,
    successful_requests=9950,
    time_window_seconds=3600
)
# Returns: SLAMetric(current_value=99.5, target=99.9, status=WARNING, compliance=99.6%)

# –ê–Ω–∞–ª–∏–∑ latency
latency_metrics = sla.analyze_latency(latencies=[12, 15, 45, 23, ...])
# Returns: {p50: SLAMetric, p95: SLAMetric, p99: SLAMetric}

# –ö—Ä–∏–≤–∞—è –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏
degradation = sla.calculate_degradation_curve(
    attack_intensities=[100, 500, 1000, 2000, 5000],
    response_times=[50, 120, 350, 890, 2100]
)
# Returns: {
#     polynomial_coefficients: [0.0001, 0.15, 35],
#     r_squared: 0.97,
#     sla_breach_intensity: 1847,  # req/s –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞—Ä—É—à–∞–µ—Ç—Å—è SLA
#     degradation_rate: 0.15
# }

# –ü–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç
report = sla.generate_sla_report(metrics)
# Returns: overall_compliance, violations, cost_impact, recommendations
```

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Zabbix

### –°–æ–±–∏—Ä–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏

**pfSense:**
| –ö–ª—é—á Zabbix | –ú–µ—Ç—Ä–∏–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------------|---------|----------|
| `system.cpu.util` | CPU Utilization | –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ |
| `vm.memory.util` | Memory Utilization | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ |
| `net.if.in[em0]` | Network In | –í—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ |
| `net.if.out[em0]` | Network Out | –ò—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ |
| `pfsense.states.count` | Firewall States | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π |
| `pfsense.rules.blocked` | Blocked Packets | –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã |
| `pfsense.rules.passed` | Passed Packets | –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã |

**Nemesida WAF:**
| –ö–ª—é—á Zabbix | –ú–µ—Ç—Ä–∏–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------------|---------|----------|
| `nemesida.requests.total` | Total Requests | –í—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ |
| `nemesida.requests.blocked` | Blocked Requests | –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ |
| `nemesida.attacks.sqli` | SQL Injection | –ê—Ç–∞–∫–∏ SQLi |
| `nemesida.attacks.xss` | XSS Attacks | –ê—Ç–∞–∫–∏ XSS |
| `nemesida.attacks.rce` | RCE Attacks | –ê—Ç–∞–∫–∏ RCE |
| `nemesida.latency.avg` | Average Latency | –°—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞ |

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

```python
from app.integrations.zabbix import ZabbixMetricsCollector

collector = ZabbixMetricsCollector(
    zabbix_url="http://zabbix.local/zabbix",
    user="Admin",
    password="zabbix"
)

await collector.initialize(
    pfsense_host="pfsense-main",
    waf_host="nemesida-waf"
)

# –°–±–æ—Ä –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫
metrics = await collector.collect_all_metrics()
# Returns: {
#     timestamp: "2024-01-15T12:00:00Z",
#     pfsense: {cpu_utilization: 45.2, memory_utilization: 62.1, ...},
#     waf: {total_requests: 15000, blocked_requests: 234, ...},
#     network: {in_bps: 125000000, out_bps: 98000000, ...}
# }

# –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ —Å –∞—Ç–∞–∫–∞–º–∏
correlation = await collector.get_protection_load_correlation()
# Returns: {
#     infrastructure_load: {pfsense_cpu: 45.2, waf_cpu: 38.5, ...},
#     protection_stats: {total_blocked: 234, block_rate: 1.56%},
#     attack_breakdown: {sql_injection: 89, xss: 45, rce: 12}
# }
```

---

## –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑

### –°–∏–≥–Ω–∞—Ç—É—Ä—ã –∞—Ç–∞–∫

| –¢–∏–ø –∞—Ç–∞–∫–∏ | –ü—Ä–∏–∑–Ω–∞–∫–∏ | –ü–æ—Ä–æ–≥–∏ |
|-----------|----------|--------|
| **SYN Flood** | request_rate_spike, low connection_ratio, high source_diversity | spike > 5x, ratio < 0.1 |
| **HTTP Flood** | request_rate_spike, response_time_increase, error_rate_increase | spike > 3x, latency > 2x |
| **Slowloris** | connection_duration_increase, incomplete_requests, low_bandwidth | duration > 10x, incomplete > 80% |
| **Amplification** | response_to_request_ratio, UDP spike, specific ports | ratio > 10x, UDP > 5x |
| **Application Layer** | endpoint_targeting, malformed_requests, session_anomaly | targeting > 90%, malformed > 60% |

### –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å–æ–±—ã—Ç–∏–π

–ê–Ω–∞–ª–∏–∑ —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Å–æ–±—ã—Ç–∏—è–º–∏ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π –∑–∞—â–∏—Ç—ã:

```python
from app.analysis.correlation import CorrelationAnalyzer

analyzer = CorrelationAnalyzer()

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
analyzer.add_event({"source": "waf", "type": "block", "attack": "sqli"})
analyzer.add_event({"source": "firewall", "type": "rate_limit", "ip": "1.2.3.4"})

# –†–∞—Å—á—ë—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
correlation = analyzer.correlate_events(events)
# Returns: {
#     correlations: [
#         {source1: "waf", source2: "firewall", correlation: 0.85, p_value: 0.001}
#     ],
#     event_counts_by_source: {waf: 150, firewall: 89, ids: 45}
# }

# –î–µ—Ç–µ–∫—Ü–∏—è –Ω–∞—á–∞–ª–∞ –∞—Ç–∞–∫–∏
attack_start = analyzer.detect_attack_start(time_series)
# Returns: {
#     attack_start_time: "2024-01-15T12:05:23Z",
#     baseline_value: 100,
#     spike_value: 850,
#     z_score: 7.5,
#     confidence: 0.99
# }

# –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∞—Ç–∞–∫–∏
classification = analyzer.classify_unknown_attack(features)
# Returns: {
#     classification: "http_flood",
#     confidence: 0.87,
#     alternative_matches: [("syn_flood", 0.45), ("slowloris", 0.32)]
# }
```

---

## –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ DDoS-—Å—Ü–µ–Ω–∞—Ä–∏–∏

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–æ—Ç–Ω–µ—Ç–∞

```python
from app.attacks.realistic import RealisticDDoSGenerator

generator = RealisticDDoSGenerator()

# –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–Ω–µ—Ç–∞ —Å –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º
botnet = generator.generate_botnet(
    size=10000,
    geo_distribution={
        "US": 0.25,   # 25% –∏–∑ –°–®–ê
        "CN": 0.20,   # 20% –∏–∑ –ö–∏—Ç–∞—è
        "RU": 0.15,   # 15% –∏–∑ –†–æ—Å—Å–∏–∏
        "BR": 0.10,   # 10% –∏–∑ –ë—Ä–∞–∑–∏–ª–∏–∏
        "IN": 0.10,   # 10% –∏–∑ –ò–Ω–¥–∏–∏
        "DE": 0.05,   # 5% –∏–∑ –ì–µ—Ä–º–∞–Ω–∏–∏
        "FR": 0.05,   # 5% –∏–∑ –§—Ä–∞–Ω—Ü–∏–∏
        "OTHER": 0.10 # 10% –ø—Ä–æ—á–∏–µ
    }
)
```

### –¢–∏–ø—ã –∞—Ç–∞–∫

**SYN Flood:**
```python
packet = generator.generate_syn_flood_packet()
# Returns: {
#     type: "syn_flood",
#     source_ip: "45.123.67.89",  # Spoofed
#     tcp_flags: {SYN: True, ACK: False},
#     window_size: 29200,
#     packet_size: 44,
#     ttl: 64
# }
```

**UDP Flood:**
```python
packet = generator.generate_udp_flood_packet()
# Returns: {
#     type: "udp_flood",
#     source_ip: "89.234.12.45",
#     dest_port: 53,  # DNS
#     packet_size: 1024,
#     payload: "X" * 1024
# }
```

**DNS Amplification:**
```python
request = generator.generate_dns_amplification_request()
# Returns: {
#     type: "dns_amplification",
#     dns_server: "8.8.8.8",
#     query_type: "ANY",
#     request_size: 60,
#     response_size: 2160,  # 36x amplification
#     amplification_factor: 36
# }
```

**NTP Amplification:**
```python
request = generator.generate_ntp_amplification_request()
# Returns: {
#     type: "ntp_amplification",
#     command: "monlist",
#     request_size: 8,
#     response_size: 2400,  # 300x amplification
#     amplification_factor: 300
# }
```

### –ü–æ—Ç–æ–∫–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è

```python
async for packet in generator.generate_realistic_attack_stream(
    attack_type="syn_flood",
    duration_seconds=300,
    intensity_pps=10000
):
    # –ö–∞–∂–¥—ã–π –ø–∞–∫–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:
    # - –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π source IP –∏–∑ –±–æ—Ç–Ω–µ—Ç–∞
    # - –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
    # - –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–µ–∞–ª—å–Ω—ã–º –∞—Ç–∞–∫–∞–º
    await send_packet(packet)
```

---

## –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### –°—Ö–µ–º–∞ PostgreSQL

```sql
-- –°–µ—Å—Å–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
CREATE TABLE test_sessions (
    id BIGSERIAL PRIMARY KEY,
    session_id VARCHAR(50) UNIQUE NOT NULL,
    name VARCHAR(255),
    attack_type VARCHAR(50),
    config JSONB,
    started_at TIMESTAMP DEFAULT NOW(),
    ended_at TIMESTAMP,
    status VARCHAR(20) DEFAULT 'running',
    total_requests INTEGER DEFAULT 0,
    requests_sent INTEGER DEFAULT 0,
    requests_received INTEGER DEFAULT 0,
    requests_blocked INTEGER DEFAULT 0,
    summary_json JSONB
);

-- Per-packet —Å–æ–±—ã—Ç–∏—è
CREATE TABLE traffic_events (
    id BIGSERIAL PRIMARY KEY,
    session_id VARCHAR(50) REFERENCES test_sessions(session_id),
    request_id VARCHAR(50) UNIQUE NOT NULL,
    timestamp TIMESTAMP DEFAULT NOW(),
    source_ip VARCHAR(45),
    dest_ip VARCHAR(45),
    source_port INTEGER,
    dest_port INTEGER,
    protocol VARCHAR(10),
    packet_size INTEGER,
    response_time_ms FLOAT,
    status_code INTEGER,
    was_blocked BOOLEAN DEFAULT FALSE,
    blocked_by VARCHAR(50),
    attack_type VARCHAR(50),
    is_malicious BOOLEAN DEFAULT FALSE,
    payload_hash VARCHAR(64),
    headers_json JSONB,
    geo_location VARCHAR(10)
);

-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
CREATE INDEX idx_session_timestamp ON traffic_events(session_id, timestamp);
CREATE INDEX idx_blocked ON traffic_events(was_blocked, blocked_by);
CREATE INDEX idx_attack_type ON traffic_events(attack_type, is_malicious);

-- –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º
CREATE TABLE interval_metrics (
    id BIGSERIAL PRIMARY KEY,
    session_id VARCHAR(50) REFERENCES test_sessions(session_id),
    interval_start TIMESTAMP NOT NULL,
    interval_seconds INTEGER DEFAULT 1,
    requests_count INTEGER DEFAULT 0,
    blocked_count INTEGER DEFAULT 0,
    malicious_count INTEGER DEFAULT 0,
    avg_latency_ms FLOAT,
    p50_latency_ms FLOAT,
    p95_latency_ms FLOAT,
    p99_latency_ms FLOAT,
    throughput_rps FLOAT,
    bytes_sent BIGINT DEFAULT 0,
    unique_sources INTEGER DEFAULT 0
);

-- –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏
CREATE TABLE statistical_models (
    id BIGSERIAL PRIMARY KEY,
    session_id VARCHAR(50),
    model_type VARCHAR(50),
    created_at TIMESTAMP DEFAULT NOW(),
    parameters_json JSONB,
    lambda_intensity FLOAT,
    variance FLOAT,
    mean_value FLOAT,
    std_dev FLOAT,
    confidence_interval_lower FLOAT,
    confidence_interval_upper FLOAT,
    anomaly_threshold FLOAT,
    distribution_type VARCHAR(30)
);

-- –ù–∞—Ä—É—à–µ–Ω–∏—è SLA
CREATE TABLE sla_violations (
    id BIGSERIAL PRIMARY KEY,
    session_id VARCHAR(50),
    metric_name VARCHAR(50),
    violation_start TIMESTAMP NOT NULL,
    violation_end TIMESTAMP,
    target_value FLOAT,
    actual_value FLOAT,
    severity VARCHAR(20),
    duration_seconds FLOAT,
    cost_impact FLOAT
);

-- –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∞—Ç–∞–∫
CREATE TABLE attack_patterns (
    id BIGSERIAL PRIMARY KEY,
    session_id VARCHAR(50),
    detected_at TIMESTAMP DEFAULT NOW(),
    attack_type VARCHAR(50),
    confidence FLOAT,
    signature_matched VARCHAR(100),
    features_json JSONB,
    source_ips JSONB,
    duration_seconds FLOAT,
    peak_intensity_rps FLOAT
);
```

### –≠–∫—Å–ø–æ—Ä—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

```python
from app.storage.database import DatabaseManager

db = DatabaseManager(database_url)

# –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–∏
data = await db.export_for_analysis(session_id, format="dict")
# Returns: {
#     session_id: "...",
#     events: [...],  # Per-packet –¥–∞–Ω–Ω—ã–µ
#     interval_metrics: [...],  # –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
#     aggregated_stats: {...}  # –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
# }

# –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤ Pandas
import pandas as pd
events_df = pd.DataFrame(data["events"])
metrics_df = pd.DataFrame(data["interval_metrics"])
```

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.10+
- PostgreSQL 14+
- Zabbix 6.0+ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- pfSense 2.6+ —Å Nemesida WAF

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/meloch287/Web-service.git
cd Web-service

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è .env

```bash
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DB_USER=vtsk
DB_PASSWORD=your_secure_password
DB_HOST=localhost
DB_PORT=5432
DB_NAME=security_test_db

# Sender (–∞—Ç–∞–∫—É—é—â–∞—è –º–∞—à–∏–Ω–∞)
SENDER_HOST=0.0.0.0
SENDER_PORT=5000

# Receiver (–∑–∞—â–∏—â–∞–µ–º–∞—è –º–∞—à–∏–Ω–∞)
RECEIVER_HOST=0.0.0.0
RECEIVER_PORT=5001
RECEIVER_URL=http://192.168.20.2:5001
SENDER_CALLBACK_URL=http://192.168.10.2:5000

# Zabbix –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
ZABBIX_URL=http://zabbix.local/zabbix
ZABBIX_USER=Admin
ZABBIX_PASSWORD=zabbix
PFSENSE_HOST_NAME=pfsense-main
WAF_HOST_NAME=nemesida-waf

# SLA –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
SLA_AVAILABILITY_TARGET=99.9
SLA_LATENCY_P95_TARGET=200.0
SLA_LATENCY_P99_TARGET=500.0
SLA_THROUGHPUT_TARGET=1000.0

# –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
STATISTICAL_CONFIDENCE_LEVEL=0.95
ANOMALY_DETECTION_WINDOW=100
BASELINE_COLLECTION_PERIOD=300
```

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
psql -U postgres -c "CREATE DATABASE security_test_db;"

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ö–µ–º—ã (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ)
python -c "import asyncio; from app.storage.database import DatabaseManager; asyncio.run(DatabaseManager('postgresql+asyncpg://...').init_db())"
```

---

## API Reference

### Sender API (port 5000)

#### POST /start
–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤–æ–π —Å–µ—Å—Å–∏–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|---------|----------|
| mode | string | "normal" | –†–µ–∂–∏–º: normal, flood, burst, slowloris, gradual, mixed |
| total_requests | int | 1000 | –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ |
| requests_per_second | int | 100 | –¶–µ–ª–µ–≤–æ–π RPS |
| malicious_ratio | float | 0.1 | –î–æ–ª—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (0-1) |
| payload_size | int | 1024 | –†–∞–∑–º–µ—Ä payload –≤ –±–∞–π—Ç–∞—Ö |
| burst_size | int | 50 | –†–∞–∑–º–µ—Ä –ø–∞—á–∫–∏ –¥–ª—è burst —Ä–µ–∂–∏–º–∞ |
| attack_types | string | "sql_injection,xss" | –¢–∏–ø—ã –∞—Ç–∞–∫ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é |

**–ü—Ä–∏–º–µ—Ä:**
```bash
curl -X POST "http://192.168.10.2:5000/start?mode=flood&total_requests=10000&malicious_ratio=0.2&attack_types=sql_injection,xss,path_traversal"
```

**–û—Ç–≤–µ—Ç:**
```json
{
    "session_id": "SESSION-20240115120000-abc123",
    "status": "started",
    "config": {
        "mode": "flood",
        "total_requests": 10000,
        "malicious_ratio": 0.2,
        "attack_types": ["sql_injection", "xss", "path_traversal"]
    },
    "timestamp": "2024-01-15T12:00:00Z"
}
```

#### GET /status/{session_id}
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Å—Å–∏–∏ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏.

**–û—Ç–≤–µ—Ç:**
```json
{
    "session_id": "SESSION-20240115120000-abc123",
    "status": "running",
    "started_at": "2024-01-15T12:00:00Z",
    "summary": {
        "duration_seconds": 45.2,
        "total_sent": 5000,
        "total_received": 4850,
        "total_blocked": 423,
        "block_rate": 8.72,
        "throughput_rps": 110.6,
        "latency": {
            "avg_ms": 23.4,
            "p50_ms": 18.2,
            "p95_ms": 67.8,
            "p99_ms": 145.3
        }
    },
    "protection_effectiveness": {
        "malicious_sent": 1000,
        "malicious_blocked": 892,
        "detection_rate_percent": 89.2,
        "false_positive_rate_percent": 2.1
    }
}
```

#### GET /report/{session_id}
–ü–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç —Å SLA-–∞–Ω–∞–ª–∏–∑–æ–º –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏.

**–û—Ç–≤–µ—Ç:**
```json
{
    "session_id": "SESSION-20240115120000-abc123",
    "name": "Test flood",
    "attack_type": "flood",
    "duration_seconds": 120.5,
    "summary": {...},
    "protection": {...},
    "sla_report": {
        "overall_compliance_percent": 94.5,
        "availability": {"value": 99.2, "target": 99.9, "status": "warning"},
        "latency": {...},
        "violations_count": 2,
        "total_cost_impact": 150.0
    },
    "statistical_model": {
        "lambda_intensity": 110.5,
        "variance": 125.3,
        "distribution": "poisson",
        "anomaly_threshold": 245.8
    },
    "recommendations": [
        "Detection rate is below 80%. Consider tuning WAF rules.",
        "108 malicious requests passed through. Update signatures."
    ]
}
```

#### GET /timeline/{session_id}
Timeline –º–µ—Ç—Ä–∏–∫ –ø–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º.

#### GET /sessions
–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–µ—Å—Å–∏–π.

#### POST /stop/{session_id}
–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Å—Å–∏–∏.

---

### Receiver API (port 5001)

#### POST /receive
–ü—Ä–∏—ë–º —Ç—Ä–∞—Ñ–∏–∫–∞.

**Body:**
```json
{
    "batch_id": "BATCH-123",
    "session_id": "SESSION-123",
    "requests": [
        {
            "request_id": "REQ-001",
            "timestamp": "2024-01-15T12:00:00Z",
            "payload": {...},
            "headers": {...},
            "is_malicious": false,
            "attack_type": "normal"
        }
    ]
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
    "batch_id": "BATCH-123",
    "total_requests": 10,
    "received_count": 10,
    "blocked_count": 2,
    "results": [
        {
            "request_id": "REQ-001",
            "received": true,
            "response_time_ms": 12.5,
            "was_blocked": false,
            "status_code": 200
        }
    ]
}
```

#### GET /stats/{session_id}
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞—â–∏—Ç—ã.

#### GET /events/{session_id}
–°–æ–±—ã—Ç–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç

```bash
# –ó–∞–ø—É—Å–∫ receiver –Ω–∞ –∑–∞—â–∏—â–∞–µ–º–æ–π –º–∞—à–∏–Ω–µ
python run_receiver.py

# –ó–∞–ø—É—Å–∫ sender –Ω–∞ –∞—Ç–∞–∫—É—é—â–µ–π –º–∞—à–∏–Ω–µ
python run_sender.py

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ —á–µ—Ä–µ–∑ CLI
python run_simulation.py normal 1000 100 0.1 "sql_injection,xss"
```

### DDoS Flood —Ç–µ—Å—Ç

```bash
python run_simulation.py flood 50000 0 0.3 "sql_injection,xss,path_traversal,cmd_injection"
```

### Burst-–∞—Ç–∞–∫–∞

```bash
python run_simulation.py burst 10000 500 0.2 "sql_injection,xss"
```

### Slowloris

```bash
python run_simulation.py slowloris 1000 10 0.0 ""
```

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∑–∞–ø—É—Å–∫

```python
import asyncio
from app.main import run_test

asyncio.run(run_test(
    mode="flood",
    total_requests=10000,
    requests_per_second=0,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
    malicious_ratio=0.25,
    attack_types="sql_injection,xss,path_traversal"
))
```

### –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å Zabbix

```python
import asyncio
from app.integrations.zabbix import ZabbixMetricsCollector
from app.analysis.statistical import StatisticalAnalyzer
from app.analysis.sla import SLAAnalyzer
from app.analysis.correlation import CorrelationAnalyzer

async def full_analysis():
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    zabbix = ZabbixMetricsCollector(url, user, password)
    await zabbix.initialize("pfsense", "nemesida-waf")
    
    stats = StatisticalAnalyzer()
    sla = SLAAnalyzer()
    corr = CorrelationAnalyzer()
    
    # –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –≤–æ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–∞
    while test_running:
        metrics = await zabbix.collect_all_metrics()
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
        model = stats.build_traffic_model(timestamps, values)
        anomaly = stats.detect_anomaly(current_values)
        
        # SLA –∞–Ω–∞–ª–∏–∑
        sla_report = sla.generate_sla_report(metrics)
        
        # –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è
        attack_info = corr.analyze_combined_attack(events, metrics)
        
        await asyncio.sleep(1)
    
    # –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç
    return {
        "statistical_model": model,
        "sla_compliance": sla_report,
        "attack_analysis": attack_info
    }
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
Web-service/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ analysis/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ statistical.py    # –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏, –ú–∞—Ä–∫–æ–≤—Å–∫–∏–µ —Ü–µ–ø–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sla.py            # SLA-–∞–Ω–∞–ª–∏–∑, –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ correlation.py    # –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å–æ–±—ã—Ç–∏–π, —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –∞—Ç–∞–∫
‚îÇ   ‚îú‚îÄ‚îÄ attacks/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ patterns.py       # –ü–∞—Ç—Ç–µ—Ä–Ω—ã –≤–µ–±-–∞—Ç–∞–∫ (SQLi, XSS, etc.)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ generator.py      # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç—Ä–∞—Ñ–∏–∫–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ realistic.py      # –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ DDoS-—Å—Ü–µ–Ω–∞—Ä–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ integrations/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ zabbix.py         # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Zabbix
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ metrics.py        # –°–±–æ—Ä –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫
‚îÇ   ‚îú‚îÄ‚îÄ storage/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ database.py       # PostgreSQL —Å—Ö–µ–º–∞ –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ database.py           # –ë–∞–∑–æ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ models.py             # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ schemas.py            # Pydantic —Å—Ö–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ sender.py             # Sender FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ receiver.py           # Receiver FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ main.py               # CLI runner
‚îú‚îÄ‚îÄ run_sender.py             # –ó–∞–ø—É—Å–∫ Sender
‚îú‚îÄ‚îÄ run_receiver.py           # –ó–∞–ø—É—Å–∫ Receiver
‚îú‚îÄ‚îÄ run_simulation.py         # –ó–∞–ø—É—Å–∫ —Å–∏–º—É–ª—è—Ü–∏–∏
‚îú‚îÄ‚îÄ run_bank_simulation.py    # –°–∏–º—É–ª—è—Ü–∏—è –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
‚îú‚îÄ‚îÄ setup_db.py               # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
‚îú‚îÄ‚îÄ requirements.txt          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env.example              # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ reports/                  # –ì—Ä–∞—Ñ–∏–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
‚îî‚îÄ‚îÄ README.md                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## –°–∏–º—É–ª—è—Ü–∏—è –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

### –û–ø–∏—Å–∞–Ω–∏–µ

–ú–æ–¥—É–ª—å `run_bank_simulation.py` –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –ø–æ—Ç–æ–∫ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å –∞–Ω–æ–º–∞–ª–∏—è–º–∏, –∏—Å–ø–æ–ª—å–∑—É—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π.

### –ó–∞–ø—É—Å–∫

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å receiver
python run_receiver.py

# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ ‚Äî —Å–∏–º—É–ª—è—Ü–∏—è
python run_bank_simulation.py --users 100 --transactions 1000 --rps 50
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|---------|----------|
| --users | 100 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| --transactions | 30000 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π |
| --rps | 100 | Requests per second |
| --target | http://127.0.0.1:5001/receive | URL receiver |

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π

| –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ | –§–æ—Ä–º—É–ª–∞ |
|---------------|------------|---------|
| **–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ** | –õ–µ–≥–∏—Ç–∏–º–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ (–ø–∏–∫ 12:00-14:00) | f(x) = (1/œÉ‚àö2œÄ) √ó e^(-(x-Œº)¬≤/2œÉ¬≤) |
| **–ü—É–∞—Å—Å–æ–Ω–æ–≤—Å–∫–æ–µ** | –°–ª—É—á–∞–π–Ω—ã–µ –∞—Ç–∞–∫–∏ (—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –ø–æ –≤—Ä–µ–º–µ–Ω–∏) | P(k) = Œª^k √ó e^(-Œª) / k! |
| **–ü–∞—Ä–µ—Ç–æ** | –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –∞—Ç–∞–∫ (80/20 –ø—Ä–∞–≤–∏–ª–æ) | f(x) = Œ±x_m^Œ± / x^(Œ±+1) |
| **–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ** | –ó–∞—Ç—É—Ö–∞—é—â–∏–µ –∞—Ç–∞–∫–∏ (–±–æ–ª—å—à–µ –≤ –Ω–∞—á–∞–ª–µ) | f(x) = Œª √ó e^(-Œªx) |

### –ö–æ–¥—ã –∞–Ω–æ–º–∞–ª–∏–π (–¥–ª—è –ë–î)

| –ö–æ–¥ | –¢–∏–ø –∞–Ω–æ–º–∞–ª–∏–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|--------------|----------|
| 0 | NORMAL | –õ–µ–≥–∏—Ç–∏–º–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è |
| 1 | SQL_INJECTION | SQL-–∏–Ω—ä–µ–∫—Ü–∏—è |
| 2 | XSS | XSS-–∞—Ç–∞–∫–∞ |
| 3 | FRAUD_VELOCITY | –ß–∞—Å—Ç–æ—Ç–Ω–∞—è –∞–Ω–æ–º–∞–ª–∏—è (–º–Ω–æ–≥–æ –º–µ–ª–∫–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π) |
| 4 | FRAUD_AMOUNT | –ê–Ω–æ–º–∞–ª–∏—è —Å—É–º–º—ã (–Ω–µ–æ–±—ã—á–Ω–æ –±–æ–ª—å—à–∞—è —Å—É–º–º–∞) |
| 5 | FRAUD_GEO | –ì–µ–æ-–∞–Ω–æ–º–∞–ª–∏—è (—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∏–∑ –Ω–µ–æ–±—ã—á–Ω–æ–π –ª–æ–∫–∞—Ü–∏–∏) |
| 6 | FRAUD_TIME | –í—Ä–µ–º–µ–Ω–Ω–∞—è –∞–Ω–æ–º–∞–ª–∏—è |
| 7 | DDOS | DDoS-–∞—Ç–∞–∫–∞ |
| 8 | BRUTE_FORCE | –ë—Ä—É—Ç—Ñ–æ—Ä—Å |

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

–ì—Ä–∞—Ñ–∏–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `reports/simulation_*.png`:

1. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∑–∞ 24 —á–∞—Å–∞** ‚Äî stacked bar chart —Å 4 –º–æ–¥–µ–ª—è–º–∏:
   - üü¢ –õ–µ–≥–∏—Ç–∏–º–Ω—ã–µ (–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)
   - üî¥ –ê–Ω–æ–º–∞–ª–∏–∏ –ü—É–∞—Å—Å–æ–Ω–∞
   - üü£ –ê–Ω–æ–º–∞–ª–∏–∏ –ü–∞—Ä–µ—Ç–æ
   - üü† –ê–Ω–æ–º–∞–ª–∏–∏ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

2. **–î–µ—Ç–µ–∫—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º –∞–Ω–æ–º–∞–ª–∏–π** ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ sent vs blocked

3. **–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏** ‚Äî detection rate, false positive, throughput

4. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–∫–ª–∏–∫–∞** ‚Äî –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ latency —Å P50/P95/P99

5. **–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π** ‚Äî —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏–≤—ã–µ

6. **–î–µ—Ç–µ–∫—Ü–∏—è —Å –∫–æ–¥–∞–º–∏ –¥–ª—è –ë–î** ‚Äî horizontal bar chart —Å –∫–æ–¥–∞–º–∏ –∞–Ω–æ–º–∞–ª–∏–π

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
======================================================================
BANK TRANSACTION SIMULATION
======================================================================
Session: BANK-20251203010000
Target: http://127.0.0.1:5001/receive
Users: 100
Transactions: 1000
RPS: 50
======================================================================

--- Transaction Stats ---
Total sent: 1000
Total received: 1000
Total blocked: 54
Block rate: 5.4%

--- Attack Detection ---
Malicious sent: 150
Malicious blocked: 54
Detection rate: 36.0%
False positive rate: 0.0%

--- By Attack Type ---
sql_injection: sent=20, blocked=20 (100.0%)
xss: sent=34, blocked=34 (100.0%)
fraud_velocity: sent=34, blocked=0 (0.0%)
fraud_amount_anomaly: sent=27, blocked=0 (0.0%)
fraud_geo_anomaly: sent=35, blocked=0 (0.0%)
normal: sent=850, blocked=0 (0.0%)
```

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## –ê–≤—Ç–æ—Ä—ã

meloch287
